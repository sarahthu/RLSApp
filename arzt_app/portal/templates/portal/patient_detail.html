{% extends "portal/layout.html" %}
{% block content %}

{% if error %}
  <div style="background:#ffe3e3; padding:12px; border-radius:10px; margin-top:18px;">
    {{ error }}
  </div>
{% endif %}

{% if patient %}
  <div style="display:flex; align-items:flex-start; justify-content:space-between; gap:16px;">
    <div>
      <h2 style="margin:0 0 10px 0;">Patientendetails</h2>
      <p style="margin:0; color:#666;">Übersicht & Fragebögen</p>
    </div>

    <a href="{% url 'home' %}"
       style="text-decoration:none; padding:8px 12px; border:1px solid #ddd; border-radius:10px; background:#fff;">
      ← Zurück
    </a>
  </div>

  <!-- Patient Card -->
  <div style="
      margin-top:16px;
      background:white;
      padding:16px;
      border-radius:14px;
      box-shadow:0 6px 18px rgba(0,0,0,.06);
      border:1px solid #eee;
  ">
    <div style="display:grid; grid-template-columns: 1fr 1fr; gap:12px;">
      <div>
        <div style="font-size:12px; color:#777;">FHIR-ID</div>
        <div style="font-weight:700; font-size:16px;">{{ patient.id }}</div>
      </div>

      <div>
        <div style="font-size:12px; color:#777;">Name</div>
        <div style="font-weight:700; font-size:16px;">{{ patient.name }}</div>
      </div>

      <div>
        <div style="font-size:12px; color:#777;">Geburtsdatum</div>
        <div style="font-weight:600;">{{ patient.birthDate }}</div>
      </div>
    </div>
  </div>

  <!-- Fragebögen -->
  <div style="margin-top:22px;">
    <h3 style="margin:0 0 12px 0;">Fragebögen</h3>

    {% if questionnaires %}
      <div style="display:grid; grid-template-columns: 1fr 1fr; gap:12px;">
        {% for q in questionnaires %}
          <a href="{% url 'patient_questionnaire' patient.id q.id %}"
             style="
               display:flex;
               justify-content:space-between;
               align-items:center;
               gap:12px;
               padding:14px 14px;
               border-radius:14px;
               background:#fff;
               border:1px solid #eee;
               text-decoration:none;
               color:#111;
               box-shadow:0 6px 18px rgba(0,0,0,.04);
             "
             onmouseover="this.style.borderColor='#cfe2ff'; this.style.transform='translateY(-1px)';"
             onmouseout="this.style.borderColor='#eee'; this.style.transform='translateY(0px)';"
          >
            <div style="min-width:0;">
              <div style="font-weight:700; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;">
                {{ q.label }}
              </div>
              <div style="font-size:12px; color:#777;">
                ID: {{ q.id }}
              </div>
            </div>
          </a>
        {% endfor %}

        <!-- Sensordaten als zusätzliche Karte -->
        <a href="{% url 'patient_sensors' patient.id %}"
           style="
             display:flex;
             justify-content:space-between;
             align-items:center;
             gap:12px;
             padding:14px 14px;
             border-radius:14px;
             background:#fff;
             border:1px solid #eee;
             text-decoration:none;
             color:#111;
             box-shadow:0 6px 18px rgba(0,0,0,.04);
           "
           onmouseover="this.style.borderColor='#cfe2ff'; this.style.transform='translateY(-1px)';"
           onmouseout="this.style.borderColor='#eee'; this.style.transform='translateY(0px)';"
        >
          <div style="min-width:0;">
            <div style="font-weight:700;">Sensordaten</div>
            <div style="font-size:12px; color:#777;">(Platzhalter)</div>
          </div>

        </a>
      </div>
    {% else %}
      <p style="color:#666;">Keine Fragebögen gefunden.</p>
    {% endif %}
  </div>

{% endif %}

{% endblock %}
